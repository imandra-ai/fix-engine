box: jekyll/jekyll:3.6.2

build:
  steps:
    - bundle-install:
        path: /usr/local/bundle

    - script:
        name: initialize git submodules
        code: |
            git submodule update --init --recursive

    - script:
        name: install custom lexers
        code:
          - cp jekyll-resources/rouge-lexers/ipl.rb /usr/local/bundle/gems/rouge-2.2.1/lib/rouge/lexers/ipl.rb

    - script:
        name: create output folder
        code: mkdir _site

    - script:
        name: jekyll build
        code: jekyll build

deploy-docs:
  steps:
    - hijonathan/gh-pages@0.2.3:
        basedir: _site
        token: $GITHUB_TOKEN
        branch: gh-pages
