(* Imandra Inc. copyright 2021 *)
[@@@program]
[@@@import "../src-core-pp/encode_base_types.iml"]
open Encode_base_types;;
[@@@import "../src-core-pp/encode_datetime.iml"]
open Encode_datetime;;


let enc_req (f) (x)  =
    Some (f x)
;;

let enc_opt (f) (x)  =
    (match x with
        | None -> None
        | Some y -> (Some (f y))
    )
;;

let enc_repeat (f) (tag) (lst)  =
    (match lst with
        | [] -> []
        | lst -> ((tag,(lst |> List.length) |> (enc_req encode_int)) :: ((lst |> (List.map f)) |> (List.fold_left (fun m j -> (@) m j
        ) [])))
    )
;;

[@@@logic]
